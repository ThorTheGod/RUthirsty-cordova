# 🦊 阿狸 AI 对话系统说明

## 🎮 角色介绍

**角色**: 阿狸（Ahri）  
**称号**: 九尾妖狐  
**来源**: 英雄联盟（League of Legends）  
**性格特点**: 魅惑、聪慧、关怀、俏皮

## ✨ AI 对话生成系统

### 核心特性

本系统实现了一个**智能对话生成引擎**，能够根据上下文动态生成个性化对话，而不是简单的随机文案。

### 上下文感知

系统会实时追踪以下数据：

```javascript
{
    todayCount: 0,        // 今日喝水次数
    totalCount: 0,        // 累计喝水次数
    lastDrinkTime: null,  // 上次喝水时间
    timeOfDay: 'morning', // 当前时间段
    userMood: 'neutral'   // 用户情绪（预留）
}
```

### 时间段识别

系统自动识别5个时间段：
- **早晨** (5:00-12:00): 早上好、早安、新的一天开始啦
- **中午** (12:00-14:00): 中午好、午安、该休息一下了
- **下午** (14:00-18:00): 下午好、下午茶时间、继续加油
- **傍晚** (18:00-22:00): 傍晚好、晚上好、辛苦一天了
- **夜晚** (22:00-5:00): 夜深了、该休息了、晚安

## 🎭 对话类型

### 1. 点击对话 (Click Dialogue)

当用户点击阿狸角色时触发，包含7种对话模板：

#### 基于时间的对话
```
"早上好~ 今天还没有喝水记录呢！"
"下午好~ 做得不错！"
```

#### 基于喝水次数的对话
```
"今天还没开始喝水呢，要不要来一杯？"
"今天已经喝了5次水了，保持这个节奏~"
```

#### 基于时间间隔的对话
```
"刚喝过水，真棒~"
"距离上次喝水已经有一会儿了"
"已经超过一小时没喝水了呢"
```

#### 鼓励性对话
```
"你做得很棒，继续保持哦"
"每一次喝水都是对自己的关爱"
"你的健康，我来守护"
```

#### 俏皮对话
```
"嘿嘿，又来找我啦？"
"点我这么多次，是不是喜欢我呀？"
"别光看着我，水杯在那边呢~"
```

#### 关怀对话
```
"最近有好好照顾自己吗？"
"工作累了就休息一下，喝杯水吧"
"记得劳逸结合，喝水休息都很重要"
```

#### 成就对话
```
"刚开始使用呢，加油哦！" (< 10次)
"已经累计50次了，不错的开始！" (< 50次)
"哇，100次了！你真的很棒！" (< 100次)
"500次！简直是传奇级别的坚持！" (≥ 500次)
```

### 2. 提醒对话 (Reminder Dialogue)

定时提醒时触发，包含4种模板：

#### 时间问候提醒
```
"早上好，该喝水啦"
"下午好，该喝水啦"
```

#### 基于间隔的提醒
```
"亲爱的，好久没喝水了吧？"
"亲爱的，距离上次喝水已经有一会儿了"
```

#### 健康小贴士
```
"喝水能提高注意力哦，来喝一杯吧"
"水分充足，皮肤会更好，来喝一杯吧"
"喝水有助于新陈代谢，来喝一杯吧"
```

#### 常规提醒
```
"时间到了，该补充水分了"
"别忘了我们的约定，定时喝水哦"
"又到了喝水的时间啦"
```

### 3. 欢迎对话 (Welcome Dialogue)

首次使用时触发：

```
"你好呀，我是阿狸，九尾妖狐~ 我会陪你一起养成喝水的好习惯"
"嗨~ 初次见面，我会定时提醒你喝水哦"
"欢迎使用喝水打卡！点击我可以查看今日喝水次数"
```

### 4. 打卡后对话 (After Drink Dialogue)

完成喝水打卡后触发：

```
"太棒了！又完成一次打卡"
"很好！继续保持这个习惯"
"做得好！你的身体会感谢你的"
"完美！又向健康迈进了一步"
```

## 🧠 AI 生成逻辑

### 动态评价系统

根据今日喝水次数给出不同评价：

| 次数范围 | 评价 |
|---------|------|
| 0次 | "今天还没有喝水记录呢" |
| 1-2次 | "喝水次数还不够呢" |
| 3-5次 | "做得不错" |
| 6-9次 | "太棒了" |
| 10次+ | "哇，喝了好多水" |

### 时间间隔分析

根据距离上次喝水的时间给出提醒：

| 时间间隔 | 提醒内容 |
|---------|---------|
| < 30分钟 | "刚喝过水，真棒~" |
| 30-60分钟 | "距离上次喝水已经有一会儿了" |
| 1-2小时 | "已经超过一小时没喝水了呢" |
| > 2小时 | "好久没喝水了，快来补充水分吧" |

### 随机表情系统

每次对话自动添加随机表情：

```
💕 ✨ 🌸 💖 🌟 💫 🎀 🌺 💝 ⭐ 🌈 💙 🦊 ✨
```

## 🎨 视觉设计

### 阿狸角色特征

- **脸部**: 白皙肤色，温暖色调
- **头发**: 白色长发，飘逸自然
- **耳朵**: 狐狸耳朵，会轻微抖动
- **眼睛**: 会眨眼、眼珠会移动
- **嘴巴**: 微笑表情，会变化
- **腮红**: 淡粉色，可爱风格
- **胡须标记**: 狐狸特征

### 动画效果

1. **角色浮动**: 3秒循环，上下浮动10px
2. **眨眼动画**: 4秒循环，自然眨眼
3. **眼珠移动**: 5秒循环，左右移动
4. **微笑变化**: 3秒循环，嘴巴大小变化
5. **头发摆动**: 3.5-4.2秒循环，三束头发独立摆动
6. **耳朵抖动**: 3秒循环，两只耳朵交替抖动

## 💻 技术实现

### 核心类: AhriDialogueGenerator

```javascript
class AhriDialogueGenerator {
    constructor()           // 初始化
    updateContext(data)     // 更新上下文
    getTimeOfDay()          // 获取时间段
    getTimeGreeting()       // 获取时间问候
    getDrinkCountComment()  // 获取喝水次数评价
    getTimeBasedReminder()  // 获取基于时间的提醒
    generateDialogue(type)  // 生成对话（核心方法）
    generateClickDialogue() // 生成点击对话
    generateReminderDialogue() // 生成提醒对话
    generateWelcomeDialogue()  // 生成欢迎对话
    generateAfterDrinkDialogue() // 生成打卡后对话
    getRandomEmoji()        // 获取随机表情
}
```

### 使用示例

```javascript
// 创建实例
const ahriDialogue = new AhriDialogueGenerator();

// 生成点击对话
const clickMessage = ahriDialogue.generateDialogue('click');

// 生成提醒对话
const reminderMessage = ahriDialogue.generateDialogue('reminder');

// 生成欢迎对话
const welcomeMessage = ahriDialogue.generateDialogue('welcome');

// 生成打卡后对话
const afterDrinkMessage = ahriDialogue.generateDialogue('afterDrink');
```

## 🎯 智能特性

### 1. 上下文感知
- 实时追踪喝水数据
- 分析时间段
- 计算时间间隔

### 2. 个性化生成
- 根据喝水次数调整语气
- 根据时间段选择问候语
- 根据间隔给出不同提醒

### 3. 多样性保证
- 7种点击对话模板
- 4种提醒对话模板
- 随机选择避免重复
- 动态参数插入

### 4. 情感表达
- 鼓励性语言
- 关怀性语言
- 俏皮性语言
- 成就感反馈

## 📊 对话历史

系统自动记录最近20条对话：

```javascript
{
    type: 'click',           // 对话类型
    dialogue: '早上好...',   // 对话内容
    timestamp: 1738753200000 // 时间戳
}
```

## 🔧 扩展功能

### 未来可扩展方向

1. **情绪识别**: 根据用户行为分析情绪
2. **学习能力**: 记录用户偏好，优化对话
3. **多角色支持**: 添加更多英雄联盟角色
4. **语音合成**: 添加阿狸的语音
5. **真实AI接入**: 接入GPT/Claude API

### 接入真实AI API

如需接入真实AI API，可修改 `generateDialogue` 方法：

```javascript
async generateDialogue(type = 'click') {
    // 准备上下文
    const context = {
        todayCount: this.contextData.todayCount,
        timeOfDay: this.contextData.timeOfDay,
        // ... 其他上下文
    };
    
    // 调用AI API
    const response = await fetch('YOUR_AI_API_ENDPOINT', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            prompt: `你是阿狸，九尾妖狐。用户${type}。上下文：${JSON.stringify(context)}。请生成一句话。`,
            max_tokens: 50
        })
    });
    
    const data = await response.json();
    return data.message;
}
```

## 🌟 使用体验

### 对话示例

**早上8点，首次点击**:
> "早上好~ 今天还没有喝水记录呢！✨"

**下午3点，喝了5次水后点击**:
> "下午好~ 今天已经喝了5次水了，做得不错！💖"

**晚上9点，2小时没喝水**:
> "傍晚好~ 已经超过一小时没喝水了呢 🌸"

**完成打卡后**:
> "太棒了！又完成一次打卡 🌟"

**定时提醒**:
> "喝水能提高注意力哦，来喝一杯吧 💫"

## 📝 总结

这是一个**基于规则的智能对话生成系统**，通过：

✅ 上下文感知  
✅ 多模板组合  
✅ 动态参数插入  
✅ 随机性保证  
✅ 个性化反馈  

实现了**类似AI的对话效果**，让每次交互都充满新鲜感和个性化体验。

---

**角色**: 阿狸 🦊  
**版本**: 2.0.0  
**更新日期**: 2026-02-05  
**预览地址**: http://localhost:8000
